# ElasticSearch

## 1. 为什么要使用 Elasticsearch？

系统中的数据， 随着业务的发展，时间的推移， 将会非常多， 而业务中往往采用模糊查询进行数据的搜索， 而模糊查询会导致查询引擎放弃索引，导致系统查询数据时都是全表扫描，在百万级别的数据库中，查询效率是非常低下的，而我们使用 ES 做一个全文索引，将经常查询的系统功能的某些字段，比如说电商系统的商品表中商品名，描述、价格还有 id 这些字段我们放入 ES 索引库里，可以提高查询速度。

## 2. Elasticsearch 的 master 选举流程？

- `Elasticsearch` 的选主是 `ZenDiscovery` 模块负责的，主要包含 `Ping`（节点之间通过这个RPC来发现彼此）和 `Unicast`（单播模块包含-一个主机列表以控制哪些节点需要 `ping` 通）这两部分。
- 对所有可以成为 `master` 的节点（`node master: true`）根据 `nodeId` 字典排序，每次选举每个节点都把自己所知道节点排一次序，然后选出第一个（第0位）节点，暂且认为它是 `master` 节点。
- 如果对某个节点的投票数达到一定的值（可以成为 `master` 节点数 `n/2+1`）并且该节点自己也选举自己，
  那这个节点就是master。否则重新选举一直到满足上述条件。
- `master` 节点的职责主要包括集群、节点和索引的管理，不负责文档级别的管理；data节点可以关闭http
  功能。

